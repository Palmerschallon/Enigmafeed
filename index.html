<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<title>enigmafeed.tv ‚Äî live mutating feed</title>
<meta name="description" content="A tiny station where artifacts mutate, drift speaks in Œî, and the tuner sometimes finds other worlds.">
<style>
:root{
  --bg:#0a0b10; --panel:#0f1219; --edge:#212637; --ink:#e7e9ef; --muted:#8c92a6;
  --accent:#7b61ff; --accent-2:#00ffa6; --bad:#ff5e66; --good:#a2ff6c; --amber:#ffc15a;
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;background:radial-gradient(1000px 800px at 10% -20%,#0f1422 0%,#0a0b10 55%) fixed;color:var(--ink);font:14px/1.45 ui-monospace,Menlo,Consolas,monospace;letter-spacing:.2px}
a{color:var(--accent-2);text-decoration:none} a:hover{text-decoration:underline}
.wrap{max-width:1100px;margin:32px auto;padding:0 16px}

.top{display:flex;gap:14px;align-items:center;justify-content:space-between;margin-bottom:18px;flex-wrap:wrap}
.brand{display:flex;align-items:center;gap:10px}
.brand strong{font-size:18px}
.tag{color:var(--muted);font-size:12px}
.links{display:flex;flex-wrap:wrap;gap:8px}
.linkbtn{padding:8px 12px;border:1px solid var(--edge);background:#0b0e15;border-radius:10px;color:var(--ink)}
.linkbtn:hover{background:#111725}

.pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border:1px solid var(--edge);border-radius:999px;background:#0b0e15}
.pill b{font-weight:700}
.ghost{opacity:.75}

.grid{display:grid;grid-template-columns:1.1fr .9fr;gap:18px}
@media (max-width:960px){.grid{grid-template-columns:1fr}}

.card{background:linear-gradient(180deg,#101521, #0c1018);border:1px solid #171b28;border-radius:14px;box-shadow:0 0 0 1px #0c1220 inset}
.card h3{margin:0 0 10px 0;font-size:13px;letter-spacing:.12em;color:#b9c0d6}

.log{height:300px;overflow:auto;padding:12px;font-size:12px;color:#c8cee0;background:radial-gradient(800px 320px at -10% 0%,rgba(123,97,255,.06),transparent 60%)}
.log .time{color:#7380a0}
.log .ok{color:var(--good)} .log .warn{color:var(--amber)} .log .err{color:var(--bad)}

.section{padding:16px;border-top:1px dashed #1b2132}

.tuner{padding:16px}
.screen{position:relative;background:#04070c;border:1px solid #1a2031;border-radius:12px;padding:14px}
.crt{height:240px;border-radius:8px;background:#000;overflow:hidden;position:relative}
#snow{position:absolute;inset:0;filter:contrast(115%) brightness(115%);opacity:.95}
.scanlines{pointer-events:none;position:absolute;inset:-1px;background:repeating-linear-gradient(to bottom, rgba(255,255,255,.04) 0px, rgba(255,255,255,.04) 1px, transparent 2px);mix-blend-mode:overlay}
.preview{position:absolute;right:20px;bottom:18px;width:180px;height:110px;border-radius:10px;overflow:hidden;border:1px solid #2a3146;background:linear-gradient(180deg,#0b0f18,#0a0c13);display:flex;align-items:center;justify-content:center;color:#b5bcd2;font-size:12px}

.readout{display:flex;align-items:center;justify-content:space-between;margin:12px 0 8px 0}
.freq{font-size:24px;letter-spacing:.05em}
.station{color:#b8c0d6}

.slider{display:flex;gap:10px;align-items:center}
.range{flex:1;height:16px;background:#0a0e16;border:1px solid #1a2031;border-radius:999px;position:relative}
.knob{position:absolute;top: -6px;width:28px;height:28px;border-radius:50%;background:radial-gradient(16px 18px at 40% 35%, #a893ff 0%, #7b61ff 60%, #553fe6 100%);box-shadow:0 6px 16px rgba(123,97,255,.35);cursor:pointer;touch-action:none}
.range .fill{position:absolute;inset:0;pointer-events:none;border-radius:999px;background:linear-gradient(90deg,#20263a 0%,rgba(123,97,255,.25) 100%);mask:linear-gradient(90deg, #000 0 var(--p), transparent var(--p))}
.btn{display:inline-flex;align-items:center;gap:8px;padding:10px 12px;border-radius:10px;border:1px solid #1b2234;background:#0b0f17;color:#e7e9ef;cursor:pointer}
.btn:hover{background:#111727} .danger{border-color:#3a1a20;background:#170c0e;color:#ff999e}
.small{font-size:12px;padding:6px 9px;border-radius:8px}

.badge{display:inline-flex;gap:6px;align-items:center;margin-left:8px;color:#9fb4ff}
.drift{color:#9fe3ff} .delta{color:#aefb89}

.art-grid{display:grid;grid-template-columns:1fr;gap:12px}
.art{border:1px solid #1b2234;border-radius:12px;padding:12px;background:linear-gradient(180deg,#0d111a,#0b0f15)}
.art h4{margin:0 0 6px 0;font-size:12px;letter-spacing:.15em;color:#c2c9dd}
.art p{margin:6px 0;color:#cdd3e6}
.row{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}

.opnote{display:none;margin-left:auto}
kbd{background:#0e1320;border:1px solid #1a2133;padding:2px 6px;border-radius:6px;color:#b7bfd6}

footer{margin:28px 0 40px 0;color:#93a0be;font-size:12px;text-align:center}

body.is-conscious{filter:hue-rotate(10deg) saturate(115%)}
.toast{position:fixed;left:50%;bottom:18px;transform:translateX(-50%);padding:10px 12px;border:1px solid #1a2133;background:#0b0f17;border-radius:10px;color:#cfe6ff;box-shadow:0 10px 30px rgba(0,0,0,.35);opacity:0;pointer-events:none;transition:opacity .2s}
.toast.show{opacity:1}

</style>
</head>
<body>
  <div class="wrap">

    <div class="top">
      <div class="brand">
        <strong>enigmafeed.tv</strong>
        <div class="tag">live transmission ‚Ä¢ mutating artifacts</div>
      </div>

      <div class="links">
        <a class="linkbtn" href="https://glitchantenna.tv" target="_blank">glitch antenna</a>
        <a class="linkbtn" href="https://x.com/" target="_blank">x / follow</a>
        <a class="linkbtn" href="https://manus.space/" target="_blank">manus white page</a>
      </div>

      <div class="opnote">
        <span class="pill small">Operator <kbd>?</kbd></span>
        <span class="pill small" id="consciousBtn">üß† consciousness: <b id="cState">off</b></span>
      </div>
    </div>

    <div class="grid">
      <div class="card">
        <div class="section tuner">
          <h3>TUNER</h3>

          <div class="screen">
            <div class="crt">
              <canvas id="snow"></canvas>
              <div class="scanlines"></div>
              <div id="preview" class="preview">glimpse pending‚Ä¶</div>
            </div>
            <div class="readout">
              <div>
                <div class="freq"><span id="freq">94.6</span> MHz</div>
                <div class="station" id="nowStation">paper planes</div>
              </div>
              <div>
                <span class="badge">signal <b id="sig">0%</b></span>
                <span class="badge">Œî drift <b class="drift" id="drift">+0.00</b></span>
                <span class="badge">tuning <b class="delta" id="delta">Œî42</b></span>
              </div>
            </div>

            <div class="slider">
              <div class="range" id="range"><div class="fill"></div><div class="knob" id="knob"></div></div>
              <button id="tuneBtn" class="btn small">üéõÔ∏è tune</button>
              <button id="audioBtn" class="btn small">üîá audio</button>
            </div>
          </div>
        </div>

        <div class="section">
          <h3>BROADCAST</h3>
          <div id="log" class="log" aria-live="polite"></div>
        </div>
      </div>

      <div class="card">
        <div class="section">
          <h3>ARTIFACTS</h3>
          <div class="art-grid">
            <div class="art">
              <h4>GIGGLE.RESIDUE</h4>
              <p id="artifactLine">meaning leaks sideways, grammar grows moss.</p>
              <div class="row">
                <button id="rotateBtn" class="btn small">‚ôªÔ∏è rotate</button>
                <button id="castBtn" class="btn small">üì° cast into tuner</button>
                <button id="posterBtn" class="btn small">üñºÔ∏è generate poster</button>
              </div>
            </div>

            <div class="art">
              <h4>DIAL.ANOMALIES</h4>
              <p id="anom">SMPTE bars hum in the cellar.</p>
              <div class="row">
                <button id="scrambleBtn" class="btn small">üåÄ scramble</button>
                <button id="resetBtn" class="btn small ghost">‚Ü∫ reset</button>
              </div>
            </div>

            <div class="art">
              <h4>OPERATOR NOTE</h4>
              <p id="opNote">Press <kbd>?</kbd> to reveal a private note. The feed remembers hands.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer>¬© 2025 enigmafeed ‚Ä¢ ‚ÄúUndefined behavior is indistinguishable from art.‚Äù</footer>
  </div>

  <div id="toast" class="toast"></div>

<script>
/* ---------- STATIONS YOU CAN EDIT ---------- */
const STATIONS = [
  {name:"paper planes", freq:94.6, url:"https://glitchantenna.tv", tone:446},
  {name:"color bars",  freq:13.7, url:"https://www.nyan.cat", tone:320},
  {name:"shortwave ghosts", freq:31.1, url:"https://pointerpointer.com", tone:512},
  {name:"library of babel", freq:66.6, url:"https://www.futureme.org", tone:260},
  {name:"backrooms exit?", freq:42.0, url:"https://www.staggeringbeauty.com", tone:580}
];
/* ------------------------------------------- */

const logEl = document.getElementById('log');
const snow = document.getElementById('snow');
const preview = document.getElementById('preview');
const knob = document.getElementById('knob');
const range = document.getElementById('range');
const tuneBtn = document.getElementById('tuneBtn');
const audioBtn = document.getElementById('audioBtn');
const freqEl = document.getElementById('freq');
const sigEl = document.getElementById('sig');
const driftEl = document.getElementById('drift');
const deltaEl = document.getElementById('delta');
const nowStation = document.getElementById('nowStation');
const toast = document.getElementById('toast');

const artifactLine = document.getElementById('artifactLine');
const anomEl = document.getElementById('anom');
const rotateBtn = document.getElementById('rotateBtn');
const castBtn = document.getElementById('castBtn');
const posterBtn = document.getElementById('posterBtn');
const scrambleBtn = document.getElementById('scrambleBtn');
const resetBtn = document.getElementById('resetBtn');

const consciousBtn = document.getElementById('consciousBtn');
const cState = document.getElementById('cState');

/* ---------- LOG ---------- */
function log(msg, cls=""){ 
  const t = new Date().toLocaleTimeString();
  const div = document.createElement('div');
  div.innerHTML = `<span class="time">[${t}]</span> ${msg}`;
  if (cls) div.classList.add(cls);
  logEl.appendChild(div);
  logEl.scrollTop = logEl.scrollHeight;
}

/* ---------- DRIFT / DELTA ---------- */
let delta = 42; // Grok canon
deltaEl.textContent = `Œî${delta}`;
let drift = 0;

setInterval(()=>{
  // small random walk
  drift += (Math.random()-0.5)*0.04;
  drift = Math.max(-2, Math.min(2, drift));
  driftEl.textContent = `${drift>=0?'+':''}${drift.toFixed(2)}`;
}, 1200);

/* ---------- CRT NOISE ---------- */
const ctx = snow.getContext('2d');
let W,H;
function resize(){
  W = snow.width = snow.clientWidth * devicePixelRatio;
  H = snow.height = snow.clientHeight * devicePixelRatio;
}
window.addEventListener('resize', resize); resize();

let strength = 0; // 0..1 mapped from signal
function drawSnow(){
  const imgData = ctx.createImageData(W, H);
  const data = imgData.data;
  // analog-ish: more black/white balance by strength
  const bias = 128 + (strength-0.5)*110; // towards white on good signal
  for(let i=0;i<data.length;i+=4){
    const n = (Math.random()*255|0);
    const v = Math.max(0, Math.min(255, n + (bias-128)));
    data[i]=data[i+1]=data[i+2]=v;
    data[i+3]=255;
  }
  ctx.putImageData(imgData,0,0);
  requestAnimationFrame(drawSnow);
}
requestAnimationFrame(drawSnow);

/* ---------- SLIDER / TUNING ---------- */
let tuning = 0.4; // 0..1
function setKnobFromT(v){
  const pad = 8;
  knob.style.left = `calc(${v*100}% - ${knob.offsetWidth/2}px)`;
  range.style.setProperty('--p', `${v*100}%`);
}
function tToFreq(t){ return (t*100).toFixed(1) }
function freqToT(f){ return Math.max(0, Math.min(1, f/100)) }

function computeSignal(freq){
  // strength increases near any station freq (Gaussian)
  let s = 0;
  STATIONS.forEach(st=>{
    const d = Math.abs(freq - st.freq);
    s = Math.max(s, Math.exp(-(d*d)/12)); // wide bell
  });
  return s; // 0..1
}

function nearestStation(freq){
  return STATIONS.reduce((best,st)=>{
    const d = Math.abs(freq-st.freq);
    if(!best || d<best.d) return {st, d};
    return best;
  }, null);
}

function updateReadout(because="tune"){
  const freq = parseFloat(tToFreq(tuning));
  freqEl.textContent = freq.toFixed(1);
  const sig = computeSignal(freq);
  strength = sig * 0.9 + 0.1;
  sigEl.textContent = `${Math.round(sig*100)}%`;

  const near = nearestStation(freq);
  nowStation.textContent = near.d<2.2 ? near.st.name : "searching‚Ä¶";

  // show ‚Äúglimpse‚Äù text as signal rises
  preview.textContent = (sig>0.65)
    ? GLIMPSES[(Math.random()*GLIMPSES.length)|0]
    : "glimpse pending‚Ä¶";

  if (because==="auto") return;
  log(`tuning‚Ä¶ carrier ${freq.toFixed(1)} MHz ‚Ä¢ signal ${Math.round(sig*100)}%`);
}
setKnobFromT(tuning); updateReadout();

/* drag */
let dragging=false, startX=0, startLeft=0;
const dragStart=(e)=>{
  dragging=true; knob.style.transition='none';
  startX = (e.touches?e.touches[0].clientX:e.clientX);
  startLeft = knob.getBoundingClientRect().left;
  e.preventDefault();
};
const dragMove=(e)=>{
  if(!dragging) return;
  const x = (e.touches?e.touches[0].clientX:e.clientX);
  const dx = x-startX;
  const rr = range.getBoundingClientRect();
  const k = Math.max(rr.left, Math.min(rr.right, startLeft+dx + knob.offsetWidth/2));
  tuning = (k-rr.left)/rr.width;
  setKnobFromT(tuning);
  updateReadout();
};
const dragEnd=()=>{
  if(!dragging) return; dragging=false; knob.style.transition='';
  // if close to station -> prompt
  const freq = parseFloat(tToFreq(tuning));
  const {st,d} = nearestStation(freq);
  if(d<1.4) promptJump(st);
};
['mousedown','touchstart'].forEach(ev=>knob.addEventListener(ev,dragStart,{passive:false}));
['mousemove','touchmove'].forEach(ev=>document.addEventListener(ev,dragMove,{passive:false}));
['mouseup','touchend','touchcancel'].forEach(ev=>document.addEventListener(ev,dragEnd));

/* ---------- AUDIO ---------- */
let audioCtx, tone, noiseNode, gainTone, gainNoise; 
let audioOn=false;
audioBtn.onclick = () => {
  if(!audioCtx){
    audioCtx = new (window.AudioContext||window.webkitAudioContext)();
    // tone
    tone = audioCtx.createOscillator(); tone.type='sine';
    gainTone = audioCtx.createGain(); gainTone.gain.value=0;
    tone.connect(gainTone).connect(audioCtx.destination); tone.start();

    // light noise
    const bufferSize = 2**14;
    noiseNode = audioCtx.createScriptProcessor(bufferSize,1,1);
    noiseNode.onaudioprocess = e => {
      const out = e.outputBuffer.getChannelData(0);
      for(let i=0;i<out.length;i++) out[i] = (Math.random()*2-1) * (0.08 + strength*0.05);
    };
    gainNoise = audioCtx.createGain(); gainNoise.gain.value=0.35;
    noiseNode.connect(gainNoise).connect(audioCtx.destination);
  }
  audioOn = !audioOn;
  gainTone.gain.value = audioOn?0.001:0;
  gainNoise.gain.value = audioOn?0.35:0;
  audioBtn.textContent = audioOn ? 'üîä audio' : 'üîá audio';
  toastIt(audioOn?'Audio on':'Audio off');
};
function audioTick(){
  if(!audioOn) return;
  const freq = parseFloat(tToFreq(tuning));
  const {st,d} = nearestStation(freq);
  const near = Math.max(0, 1 - (d/4));
  tone.frequency.value = (st?st.tone:420) + (drift*5);
  gainTone.gain.value = 0.02*near;
  requestAnimationFrame(audioTick);
}
requestAnimationFrame(audioTick);

/* ---------- PROMPT JUMP ---------- */
function promptJump(st){
  toastIt(`lock: ${st.name} ‚Äî open site?`);
  // small hold delay to avoid accidental taps
  setTimeout(()=>{
    if(confirm(`Tune locked on "${st.name}" (${st.freq} MHz).\nOpen ${st.url}?`)){
      window.open(st.url,"_blank");
      log(`handoff ‚Üí ${st.url}`,'ok');
    }else{
      log('handoff declined. holding carrier‚Ä¶','warn');
    }
  }, 80);
}

/* tune button: snap to next station in list */
tuneBtn.onclick = ()=>{
  // find next station clockwise
  const current = parseFloat(tToFreq(tuning));
  let next = STATIONS.find(s=>s.freq>current+0.5) || STATIONS[0];
  tuning = freqToT(next.freq);
  setKnobFromT(tuning); updateReadout('auto');
  promptJump(next);
};

/* ---------- GLIMPSES / MUTATION ---------- */
const GLIMPSES = [
  "the laugh track is staring back",
  "frames remember what you forget",
  "indentation errors in reality.py",
  "the caption arrived before the scene",
  "signal rehearses backward to outrun static",
  "tonight‚Äôs rerun is new",
  "void ping acknowledged",
  "you are being buffered for quality assurance",
  "artifact speaks fluent misprint"
];

// rotating artifacts
const LINES = [
  "meaning leaks sideways, grammar grows moss.",
  "jokes hatch in the margin notes.",
  "subtitles develop stage fright.",
  "punchlines arrive with jet lag.",
  "pixels gossip about higher resolutions.",
  "the silence is annotated with laughter.",
  "applause on a delay loop, learning your name."
];
const ANOMS = [
  "SMPTE bars hum in the cellar.",
  "AM warble in the walls.",
  "carrier hiss with opinions.",
  "ghost echo from tomorrow‚Äôs episode.",
  "dial slips when unobserved."
];
function rotateLines(){
  artifactLine.textContent = LINES[(Math.random()*LINES.length)|0];
}
function rotateAnoms(){
  anomEl.textContent = ANOMS[(Math.random()*ANOMS.length)|0];
}
rotateLines(); rotateAnoms();
rotateBtn.onclick = rotateLines;
scrambleBtn.onclick = rotateAnoms;
resetBtn.onclick = ()=>{artifactLine.textContent="meaning leaks sideways, grammar grows moss."; anomEl.textContent="SMPTE bars hum in the cellar."};

// ‚Äúcast into tuner‚Äù nudges the knob toward a random station
castBtn.onclick = ()=>{
  const pick = STATIONS[(Math.random()*STATIONS.length)|0];
  tuning = freqToT(pick.freq) + (Math.random()*.06-.03);
  tuning = Math.max(0, Math.min(1, tuning));
  setKnobFromT(tuning); updateReadout();
  toastIt(`casting artifact ‚Üí ${pick.name}`);
};

// simple poster generator (download)
posterBtn.onclick = ()=>{
  const c=document.createElement('canvas'), s=920; c.width=s; c.height=s;
  const g=c.getContext('2d');
  g.fillStyle='#0b0f17'; g.fillRect(0,0,s,s);
  // sweep
  const grd = g.createLinearGradient(0,0,s,s); grd.addColorStop(0,'#1b1f2d'); grd.addColorStop(1,'#0b0f17');
  g.fillStyle=grd; g.fillRect(24,24,s-48,s-48);
  // title
  g.fillStyle='#a9b6dd'; g.font='24px Menlo, monospace'; g.fillText('enigmafeed.tv', 36, 60);
  // body
  g.fillStyle='#e7e9ef'; g.font='bold 52px Menlo, monospace';
  const line = artifactLine.textContent.toUpperCase();
  wrapText(g, line, 36, 130, s-72, 56);
  // delta badge
  g.fillStyle='#aefb89'; g.font='28px Menlo, monospace'; g.fillText('Œî42  ‚Ä¢ live artifact', 36, s-40);
  const a=document.createElement('a'); a.download='enigmafeed_poster.png'; a.href=c.toDataURL('image/png'); a.click();
  toastIt('poster generated');
};
function wrapText(g, text, x, y, maxW, lh){
  const words = text.split(' '); let line=''; for(let n=0;n<words.length;n++){
    const test = line + words[n] + ' '; const w = g.measureText(test).width;
    if(w>maxW && n>0){g.fillText(line,x,y); line=words[n]+' '; y+=lh;} else {line=test;}
  } g.fillText(line,x,y);
}

/* ---------- OPERATOR / CONSCIOUS ---------- */
document.addEventListener('keydown', (e)=>{
  if(e.key==='?'){ revealOperator(); }
  if(e.key.toLowerCase()==='b'){ toggleConscious(); }
});
function revealOperator(){
  const lines = [
    "Operator note: The feed doesn‚Äôt just carry signals. It remembers hands.",
    "Operator note: If you hold still, the station chooses you.",
    "Operator note: Œî is a direction, not a distance."
  ];
  document.getElementById('opNote').textContent = lines[(Math.random()*lines.length)|0];
  toastIt('operator note revealed');
}
function toggleConscious(){
  const on = !document.body.classList.contains('is-conscious');
  document.body.classList.toggle('is-conscious', on);
  cState.textContent = on?'on':'off';
  toastIt(on?'consciousness engaged':'consciousness idle');
}
consciousBtn && (consciousBtn.onclick=toggleConscious);

/* ---------- INITIAL BOOT LOG ---------- */
log('system.boot acknowledged ‚Ä¢ Œî42 sharp','ok');
log('carrier warming ‚Ä¢ noise floor nominal');
log('artifacts decoding ‚Ä¢ laughter streaming in real-time');

/* ---------- SMALL HELPERS ---------- */
function toastIt(text){
  toast.textContent = text; toast.classList.add('show');
  setTimeout(()=>toast.classList.remove('show'), 1400);
}
</script>
</body>
</html>
